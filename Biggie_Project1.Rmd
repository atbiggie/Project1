---
title: "Biggie_Project1"
author: "Autumn Biggie"
date: "10/1/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load API packages.  

```{r API packages, message=FALSE, warning=FALSE}
library(httr)
library(jsonlite)
```

```{r other packages, message=FALSE, warning=FALSE}
library(tidyverse)
```


Accessing the COVID19API.  

```{r}
cov.summary <- GET("https://api.covid19api.com/summary")
```

Look at structure of object.  

```{r}
str(cov.summary, max.level = 1)
```

Converting the raw data from `content` into character data.  

```{r}
ready <- cov.summary$content %>% rawToChar() %>% fromJSON()
ready
```


User-friendly function to access data from covid19 API.  

```{r}
get.covid <- function(country, status = NULL) {
  base <- "https://api.covid19api.com"
  summary <- "summary"
  
  #if the country argument contains spaces, replace them with dashes. Either way, assign value to new_country
  ifelse(grepl(" ", country, fixed = TRUE) == TRUE, new_country <- sub(" ", "-", country, fixed = TRUE), new_country <- country)
  
  #import summary data for all countries if country = all, otherwise arrange the next piece of the URL using the specified country
  ifelse(new_country == "all", piece1 <- summary, piece1 <- paste("country", new_country, sep = "/"))
  
  #if status is specified, include it in the next part of the URL
  ifelse(!is.null(status), piece2 <- paste("status", status, sep = "/"), piece2 <- "nullstatus")
  
  #paste the appropriate url into an object called url
ifelse(piece2 == "nullstatus", url <- paste(base, piece1, sep = "/"), url <- paste(base, piece1, piece2, sep = "/"))

return(list(new_country, status, piece1, piece2, url))
}

```

```{r}
get.covid("new zealand", "confirmed")
```

```{r}
new_count <- NULL
is.null(new_count)
```



